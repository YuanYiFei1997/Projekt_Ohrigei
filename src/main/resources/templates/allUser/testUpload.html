<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="../js/jquery-3.4.1.min.js"></script>
    <script src="../js/sb-admin-2.js"></script>
    <script src="../js/popper.min.js"></script>
    <script src="../js/bootstrap.js"></script>
    <script src="../js/jquery.easing.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/cropper.js"></script>
    <script src="../js/jquery-cropper.js"></script>
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/sb-admin-2.css" rel="stylesheet">
    <link href="../css/font-awesome.css" rel="stylesheet">
    <link href="../css/googleapis.css" rel="stylesheet">
    <link href="../css/cropper.css" rel="stylesheet">
    <title>Title</title>
</head>
<body>
<!--<a class="btn btn-primary" href="#" data-toggle="modal" data-target="#testModal">-->
<!--    <i class="fa fa-image fa-fw mr-2 text-gray-400"></i>-->
<!--    选择头像-->
<!--</a>-->
<button class="btn btn-primary" onclick="showDIV()">上传头像</button>
<div class="card col-xl-6 align-items-center m-auto" hidden="hidden">
    <div class="card-body">
        <button id="uploadButton" class="btn btn-primary" onclick="$('#uploadFile').click();">上传</button>
        <img src="" alt="" id="img" style="max-width: 100%;height: auto;">
        <input name="file" type="file" style="display: none" id="uploadFile"
               accept="image/jpg, image/png, image/jpeg">
    </div>
    <div class="card-footer">
        <button class="btn btn-secondary" type="button">取消</button>
        <a class="btn btn-primary" href="#">确认</a>
    </div>
</div>

<div class="modal fade" id="testModal" tabindex="-1" role="dialog" aria-labelledby="testModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="testModalLabel">选择头像</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <!--                <div class="box">-->
                <!--                    <button id="uploadButton" class="btn btn-primary" onclick="$('#uploadFile').click();">上传</button>-->
                <!--                    <img src="" alt="" id="img" style="max-width: 100%;height: auto;">-->
                <!--                    <input name="file" type="file" style="display: none" id="uploadFile"-->
                <!--                           accept="image/jpg, image/png, image/jpeg">-->
                <!--                </div>-->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">取消</button>
                <a class="btn btn-primary" href="#">确认</a>
            </div>
        </div>
    </div>
</div>
<script>
    function showDIV() {
        $("div").removeAttr("hidden")
    }

    $(function () {
        $("#uploadFile").change(function () {
            uploadImg(this);
        })
    });

    function uploadImg(tag) {
        var file = tag.files[0];
        var reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = function () {
            console.log(this.result);
            var imgSrc = this.result;
            $("#uploadButton").attr("hidden", "hidden");
            $("#img").cropper('replace', imgSrc, false);
        }
    }

    $('#img').cropper({
        aspectRatio: 1 / 1,
        viewMode: 1,
        dragMode: "move",
        crop: function (e) {
            console.log(e);
        }
    });
</script>
</body>
</html>